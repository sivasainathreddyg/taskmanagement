<mvc:View
    controllerName="com.taskmanagement.taskmanagement.controller.Dashboard"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    xmlns:viz="sap.viz.ui5.controls"
    xmlns:viz.data="sap.viz.ui5.data"
    xmlns:viz.feeds="sap.viz.ui5.controls.common.feeds"
>
    <Page
        title="Dashboard"
        showNavButton="true"
        navButtonPress="onpresshome"
    >
        <!-- <headerContent>
            <Button
                text="Show Summary"
                press="onShowSummary"
                width="150px"
                type="Emphasized"
                class="sapUiTinyMarginBottom"
            />
        </headerContent> -->
        <Toolbar>
            <!-- Task Type -->
            <ToolbarSpacer />
            <ComboBox
                id="taskTypeCombo"
                selectionChange="onTaskTypeChange"
                placeholder="Task Type"
            >
                <items>
                    <core:Item
                        key="All"
                        text="Summary"
                    />
                    <core:Item
                        key="INC"
                        text="Incident"
                    />
                    <core:Item
                        key="CHG"
                        text="Change Request"
                    />
                    <core:Item
                        key="DEF"
                        text="PRC Defect"
                    />
                </items>
            </ComboBox>

            <!-- <ComboBox
                id="employeeCombo"
                items="{employeeModel>/Employee}"
            >
                <core:Item
                    key="{employeeModel>id}"
                    text="{employeeModel>name}"
                />
            </ComboBox> -->
            <MultiComboBox
                id="employeeMultiCombo"
                selectionChange="onEmployeeSelectionChange"
                placeholder="Select Employees"
                width="250px"
                items="{employeeModel>/Employee}"
            >
                <core:Item
                    key="{employeeModel>id}"
                    text="{employeeModel>name}"
                />
            </MultiComboBox>
            <ComboBox
                id="chartTypeCombo"
                selectedKey="Type"
                width="250px"
            >
                <items>
                    <core:Item
                        key="Type"
                        text="Type"
                    />
                    <core:Item
                        key="Status"
                        text="Status"
                    />
                </items>
            </ComboBox>

            <!-- Date Pickers -->
            <DatePicker
                width="250px"
                id="startDatePicker"
                placeholder="Start Date"
            />
            <DatePicker
                width="250px"
                id="endDatePicker"
                placeholder="End Date"
            />

            <!-- Apply Button -->
            <Button
                width="100px"
                text="Apply Filter"
                press="onApplyFilter"
            />
        </Toolbar>

        <viz:VizFrame
            id="summaryChart"
            uiConfig="{applicationSet:'fiori'}"
            height="400px"
            width="100%"
            vizType="pie"
            visible="false"
            vizProperties="{
		   plotArea:{
                            dataLabel:{visible: true, type:'value'}, drawingEffect: 'glossy' 
			    },
                            title : {text:'Count'}
		    }"
            selectData="myOnClickHandler"
         
            renderComplete="handleRenderComplete"
        >
            <viz:dataset>
                <viz.data:FlattenedDataset data="{summaryModel>/summaryData}">
                    <viz.data:dimensions>
                        <viz.data:DimensionDefinition
                            name="category"
                            value="{summaryModel>category}"
                        />
                    </viz.data:dimensions>
                    <viz.data:measures>
                        <viz.data:MeasureDefinition
                            name="count"
                            value="{summaryModel>count}"
                        />
                    </viz.data:measures>
                </viz.data:FlattenedDataset>
            </viz:dataset>

            <viz:feeds>
                <viz.feeds:FeedItem
                    uid="size"
                    type="Measure"
                    values="count"
                />
                <viz.feeds:FeedItem
                    uid="color"
                    type="Dimension"
                    values="category"
                />
            </viz:feeds>
        </viz:VizFrame>

        <!-- Bar Chart: Type -->
        <viz:VizFrame
            id="mainChart"
            width="100%"
            height="400px"
            uiConfig="{applicationSet:'fiori'}"
            vizType="column"
        >
            <viz:dataset>
                <viz.data:FlattenedDataset data="{chartModel>/chartData}">
                    <viz.data:dimensions>
                        <viz.data:DimensionDefinition
                            name="Dimension"
                            value="{dimension}"
                        />
                    </viz.data:dimensions>
                    <viz.data:measures>
                        <viz.data:MeasureDefinition
                            name="Count"
                            value="{= parseInt(${count}) }"
                        />
                    </viz.data:measures>
                </viz.data:FlattenedDataset>
            </viz:dataset>

            <viz:feeds>
                <viz.feeds:FeedItem
                    uid="valueAxis"
                    type="Measure"
                    values="Count"
                />
                <viz.feeds:FeedItem
                    uid="categoryAxis"
                    type="Dimension"
                    values="Dimension"
                />
            </viz:feeds>
        </viz:VizFrame>
    </Page>
</mvc:View>
