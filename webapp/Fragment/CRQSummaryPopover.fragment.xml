<core:FragmentDefinition
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    xmlns:viz="sap.viz.ui5.controls"
    xmlns:viz.data="sap.viz.ui5.data"
    xmlns:vizFeeds="sap.viz.ui5.controls.common.feeds"
    draggable="true"
    resizable="true"
>
    <Popover
        id="crqsummaryPopover"
        title="Change Request Summary"
        placement="Auto"
        contentWidth="100%"
        contentHeight="100%"
        class="sapUiContentPadding"
    >
        <viz:VizFrame
            id="idcrqPieChart"
            uiConfig="{applicationSet:'fiori'}"
            vizType="pie"
            width="100%"
            height="500px"
            vizProperties="{
        plotArea: { dataLabel: { visible: true, type:'value' }, drawingEffect:'glossy' },
        title: { text:'Count' },
        legend: { visible:true , position: 'right'},
        tooltip: { visible:true }
    }"
        >
            <viz:dataset>
                <viz.data:FlattenedDataset data="{summaryModel>/}">
                    <viz.data:dimensions>
                        <viz.data:DimensionDefinition
                            name="Employee"
                            value="{summaryModel>assignedTo}"
                        />
                    </viz.data:dimensions>
                    <viz.data:measures>
                        <viz.data:MeasureDefinition
                            name="Count"
                            value="{summaryModel>count}"
                        />
                    </viz.data:measures>
                </viz.data:FlattenedDataset>
            </viz:dataset>

            <!-- âœ… Feeds must be inside viz:feeds -->
            <viz:feeds>
                <vizFeeds:FeedItem
                    uid="size"
                    type="Measure"
                    values="Count"
                />
                <vizFeeds:FeedItem
                    uid="color"
                    type="Dimension"
                    values="Employee"
                />
            </viz:feeds>

            <viz:dependents>
                <viz:Popover id="idcrqieTooltip" />
            </viz:dependents>
        </viz:VizFrame>

        <Button
            text="Close"
            type="Reject"
            press=".onCloseSummary"
            class="sapUiSmallMarginTop"
        />
    </Popover>
</core:FragmentDefinition>
